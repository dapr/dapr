/*
Copyright 2021 The Dapr Authors
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
    http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

syntax = "proto3";

package dapr.proto.runtime.v1;

import "google/protobuf/any.proto";
import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/struct.proto";
import "dapr/proto/common/v1/common.proto";
import "dapr/proto/runtime/v1/appcallback.proto";

option csharp_namespace = "Dapr.Client.Autogen.Grpc.v1";
option java_outer_classname = "DaprProtos";
option java_package = "io.dapr.v1";
option go_package = "github.com/dapr/dapr/pkg/proto/runtime/v1;runtime";

// Dapr service provides APIs to user application to access Dapr building blocks.
service Dapr {
  // Invokes a method on a remote Dapr app.
  // Deprecated: Use proxy mode service invocation instead.
  rpc InvokeService(InvokeServiceRequest) returns (common.v1.InvokeResponse) {}

  // Gets the state for a specific key.
  rpc GetState(GetStateRequest) returns (GetStateResponse) {}

  // Gets a bulk of state items for a list of keys
  rpc GetBulkState(GetBulkStateRequest) returns (GetBulkStateResponse) {}

  // Saves the state for a specific key.
  rpc SaveState(SaveStateRequest) returns (google.protobuf.Empty) {}

  // Queries the state.
  rpc QueryStateAlpha1(QueryStateRequest) returns (QueryStateResponse) {}

  // Deletes the state for a specific key.
  rpc DeleteState(DeleteStateRequest) returns (google.protobuf.Empty) {}

  // Deletes a bulk of state items for a list of keys
  rpc DeleteBulkState(DeleteBulkStateRequest) returns (google.protobuf.Empty) {}

  // Executes transactions for a specified store
  rpc ExecuteStateTransaction(ExecuteStateTransactionRequest) returns (google.protobuf.Empty) {}

  // Publishes events to the specific topic.
  rpc PublishEvent(PublishEventRequest) returns (google.protobuf.Empty) {}

  // Bulk Publishes multiple events to the specified topic.
  rpc BulkPublishEventAlpha1(BulkPublishRequest) returns (BulkPublishResponse) {}

  // SubscribeTopicEventsAlpha1 subscribes to a PubSub topic and receives topic
  // events from it.
  rpc SubscribeTopicEventsAlpha1(stream SubscribeTopicEventsRequestAlpha1) returns (stream SubscribeTopicEventsResponseAlpha1) {}

  // Invokes binding data to specific output bindings
  rpc InvokeBinding(InvokeBindingRequest) returns (InvokeBindingResponse) {}

  // Gets secrets from secret stores.
  rpc GetSecret(GetSecretRequest) returns (GetSecretResponse) {}

  // Gets a bulk of secrets
  rpc GetBulkSecret(GetBulkSecretRequest) returns (GetBulkSecretResponse) {}

  // Register an actor timer.
  rpc RegisterActorTimer(RegisterActorTimerRequest) returns (google.protobuf.Empty) {}

  // Unregister an actor timer.
  rpc UnregisterActorTimer(UnregisterActorTimerRequest) returns (google.protobuf.Empty) {}

  // Register an actor reminder.
  rpc RegisterActorReminder(RegisterActorReminderRequest) returns (google.protobuf.Empty) {}

  // Unregister an actor reminder.
  rpc UnregisterActorReminder(UnregisterActorReminderRequest) returns (google.protobuf.Empty) {}

  // Gets the state for a specific actor.
  rpc GetActorState(GetActorStateRequest) returns (GetActorStateResponse) {}

  // Executes state transactions for a specified actor
  rpc ExecuteActorStateTransaction(ExecuteActorStateTransactionRequest) returns (google.protobuf.Empty) {}

  // InvokeActor calls a method on an actor.
  rpc InvokeActor (InvokeActorRequest) returns (InvokeActorResponse) {}

  // GetConfiguration gets configuration from configuration store.
  rpc GetConfigurationAlpha1(GetConfigurationRequest) returns (GetConfigurationResponse) {}

  // GetConfiguration gets configuration from configuration store.
  rpc GetConfiguration(GetConfigurationRequest) returns (GetConfigurationResponse) {}

  // SubscribeConfiguration gets configuration from configuration store and subscribe the updates event by grpc stream
  rpc SubscribeConfigurationAlpha1(SubscribeConfigurationRequest) returns (stream SubscribeConfigurationResponse) {}

  // SubscribeConfiguration gets configuration from configuration store and subscribe the updates event by grpc stream
  rpc SubscribeConfiguration(SubscribeConfigurationRequest) returns (stream SubscribeConfigurationResponse) {}

  // UnSubscribeConfiguration unsubscribe the subscription of configuration
  rpc UnsubscribeConfigurationAlpha1(UnsubscribeConfigurationRequest) returns (UnsubscribeConfigurationResponse) {}

  // UnSubscribeConfiguration unsubscribe the subscription of configuration
  rpc UnsubscribeConfiguration(UnsubscribeConfigurationRequest) returns (UnsubscribeConfigurationResponse) {}

  // TryLockAlpha1 tries to get a lock with an expiry.
  rpc TryLockAlpha1(TryLockRequest)returns (TryLockResponse) {}

  // UnlockAlpha1 unlocks a lock.
  rpc UnlockAlpha1(UnlockRequest)returns (UnlockResponse) {}

  // EncryptAlpha1 encrypts a message using the Dapr encryption scheme and a key stored in the vault.
  rpc EncryptAlpha1(stream EncryptRequest) returns (stream EncryptResponse);

  // DecryptAlpha1 decrypts a message using the Dapr encryption scheme and a key stored in the vault.
  rpc DecryptAlpha1(stream DecryptRequest) returns (stream DecryptResponse);

  // Gets metadata of the sidecar
  rpc GetMetadata (GetMetadataRequest) returns (GetMetadataResponse) {}

  // Sets value in extended metadata of the sidecar
  rpc SetMetadata (SetMetadataRequest) returns (google.protobuf.Empty) {}

  // SubtleGetKeyAlpha1 returns the public part of an asymmetric key stored in the vault.
  rpc SubtleGetKeyAlpha1(SubtleGetKeyRequest) returns (SubtleGetKeyResponse);

  // SubtleEncryptAlpha1 encrypts a small message using a key stored in the vault.
  rpc SubtleEncryptAlpha1(SubtleEncryptRequest) returns (SubtleEncryptResponse);

  // SubtleDecryptAlpha1 decrypts a small message using a key stored in the vault.
  rpc SubtleDecryptAlpha1(SubtleDecryptRequest) returns (SubtleDecryptResponse);

  // SubtleWrapKeyAlpha1 wraps a key using a key stored in the vault.
  rpc SubtleWrapKeyAlpha1(SubtleWrapKeyRequest) returns (SubtleWrapKeyResponse);

  // SubtleUnwrapKeyAlpha1 unwraps a key using a key stored in the vault.
  rpc SubtleUnwrapKeyAlpha1(SubtleUnwrapKeyRequest) returns (SubtleUnwrapKeyResponse);

  // SubtleSignAlpha1 signs a message using a key stored in the vault.
  rpc SubtleSignAlpha1(SubtleSignRequest) returns (SubtleSignResponse);

  // SubtleVerifyAlpha1 verifies the signature of a message using a key stored in the vault.
  rpc SubtleVerifyAlpha1(SubtleVerifyRequest) returns (SubtleVerifyResponse);

  // Starts a new instance of a workflow
  rpc StartWorkflowAlpha1 (StartWorkflowRequest) returns (StartWorkflowResponse) {
    option deprecated = true;
  }

  // Gets details about a started workflow instance
  rpc GetWorkflowAlpha1 (GetWorkflowRequest) returns (GetWorkflowResponse) {
    option deprecated = true;
  }

  // Purge Workflow
  rpc PurgeWorkflowAlpha1 (PurgeWorkflowRequest) returns (google.protobuf.Empty) {
    option deprecated = true;
  }

  // Terminates a running workflow instance
  rpc TerminateWorkflowAlpha1 (TerminateWorkflowRequest) returns (google.protobuf.Empty) {
    option deprecated = true;
  }

  // Pauses a running workflow instance
  rpc PauseWorkflowAlpha1 (PauseWorkflowRequest) returns (google.protobuf.Empty) {
    option deprecated = true;
  }

  // Resumes a paused workflow instance
  rpc ResumeWorkflowAlpha1 (ResumeWorkflowRequest) returns (google.protobuf.Empty) {
    option deprecated = true;
  }

  // Raise an event to a running workflow instance
  rpc RaiseEventWorkflowAlpha1 (RaiseEventWorkflowRequest) returns (google.protobuf.Empty) {
    option deprecated = true;
  }

  // Starts a new instance of a workflow
  rpc StartWorkflowBeta1 (StartWorkflowRequest) returns (StartWorkflowResponse) {}

  // Gets details about a started workflow instance
  rpc GetWorkflowBeta1 (GetWorkflowRequest) returns (GetWorkflowResponse) {}

  // Purge Workflow
  rpc PurgeWorkflowBeta1 (PurgeWorkflowRequest) returns (google.protobuf.Empty) {}

  // Terminates a running workflow instance
  rpc TerminateWorkflowBeta1 (TerminateWorkflowRequest) returns (google.protobuf.Empty) {}

  // Pauses a running workflow instance
  rpc PauseWorkflowBeta1 (PauseWorkflowRequest) returns (google.protobuf.Empty) {}

  // Resumes a paused workflow instance
  rpc ResumeWorkflowBeta1 (ResumeWorkflowRequest) returns (google.protobuf.Empty) {}

  // Raise an event to a running workflow instance
  rpc RaiseEventWorkflowBeta1 (RaiseEventWorkflowRequest) returns (google.protobuf.Empty) {}

  // Shutdown the sidecar
  rpc Shutdown (ShutdownRequest) returns (google.protobuf.Empty) {}

  // Create and schedule a job
  rpc ScheduleJobAlpha1(ScheduleJobRequest) returns (ScheduleJobResponse) {}

  // Gets a scheduled job
  rpc GetJobAlpha1(GetJobRequest) returns (GetJobResponse) {}

  // Delete a job
  rpc DeleteJobAlpha1(DeleteJobRequest) returns (DeleteJobResponse) {}

  // Converse with a LLM service
  rpc ConverseAlpha1(ConversationRequest) returns (ConversationResponse) {}

  // Converse with a LLM service via alpha2 api
  rpc ConverseAlpha2(ConversationRequestAlpha2) returns (ConversationResponseAlpha2) {}
}

// InvokeServiceRequest represents the request message for Service invocation.
message InvokeServiceRequest {
  // Required. Callee's app id.
  string id = 1;

  // Required. message which will be delivered to callee.
  common.v1.InvokeRequest message = 3;
}

// GetStateRequest is the message to get key-value states from specific state store.
message GetStateRequest {
  // The name of state store.
  string store_name = 1;

  // The key of the desired state
  string key = 2;

  // The read consistency of the state store.
  common.v1.StateOptions.StateConsistency consistency = 3;

  // The metadata which will be sent to state store components.
  map<string, string> metadata = 4;
}

// GetBulkStateRequest is the message to get a list of key-value states from specific state store.
message GetBulkStateRequest {
  // The name of state store.
  string store_name = 1;

  // The keys to get.
  repeated string keys = 2;

  // The number of parallel operations executed on the state store for a get operation.
  int32 parallelism = 3;

  // The metadata which will be sent to state store components.
  map<string, string> metadata = 4;
}

// GetBulkStateResponse is the response conveying the list of state values.
message GetBulkStateResponse {
  // The list of items containing the keys to get values for.
  repeated BulkStateItem items = 1;
}

// BulkStateItem is the response item for a bulk get operation.
// Return values include the item key, data and etag.
message BulkStateItem {
  // state item key
  string key = 1;

  // The byte array data
  bytes data = 2;

  // The entity tag which represents the specific version of data.
  // ETag format is defined by the corresponding data store.
  string etag = 3;

  // The error that was returned from the state store in case of a failed get operation.
  string error = 4;

  // The metadata which will be sent to app.
  map<string, string> metadata = 5;
}

// GetStateResponse is the response conveying the state value and etag.
message GetStateResponse {
  // The byte array data
  bytes data = 1;

  // The entity tag which represents the specific version of data.
  // ETag format is defined by the corresponding data store.
  string etag = 2;

  // The metadata which will be sent to app.
  map<string, string> metadata = 3;
}

// DeleteStateRequest is the message to delete key-value states in the specific state store.
message DeleteStateRequest {
  // The name of state store.
  string store_name = 1;

  // The key of the desired state
  string key = 2;

  // The entity tag which represents the specific version of data.
  // The exact ETag format is defined by the corresponding data store.
  common.v1.Etag etag = 3;

  // State operation options which includes concurrency/
  // consistency/retry_policy.
  common.v1.StateOptions options = 4;

  // The metadata which will be sent to state store components.
  map<string, string> metadata = 5;
}

// DeleteBulkStateRequest is the message to delete a list of key-value states from specific state store.
message DeleteBulkStateRequest {
  // The name of state store.
  string store_name = 1;

  // The array of the state key values.
  repeated common.v1.StateItem states = 2;
}

// SaveStateRequest is the message to save multiple states into state store.
message SaveStateRequest {
  // The name of state store.
  string store_name = 1;

  // The array of the state key values.
  repeated common.v1.StateItem states = 2;
}

// QueryStateRequest is the message to query state store.
message QueryStateRequest {
  // The name of state store.
  string store_name = 1 [json_name = "storeName"];

  // The query in JSON format.
  string query = 2;

  // The metadata which will be sent to state store components.
  map<string, string> metadata = 3;
}

message QueryStateItem {
  // The object key.
  string key = 1;

  // The object value.
  bytes  data = 2;

  // The entity tag which represents the specific version of data.
  // ETag format is defined by the corresponding data store.
  string etag = 3;

  // The error message indicating an error in processing of the query result.
  string error = 4;
}

// QueryStateResponse is the response conveying the query results.
message QueryStateResponse {
  // An array of query results.
  repeated QueryStateItem results = 1;

  // Pagination token.
  string token = 2;

  // The metadata which will be sent to app.
  map<string, string> metadata = 3;
}

// PublishEventRequest is the message to publish event data to pubsub topic
message PublishEventRequest {
  // The name of the pubsub component
  string pubsub_name = 1;

  // The pubsub topic
  string topic = 2;

  // The data which will be published to topic.
  bytes data = 3;

  // The content type for the data (optional).
  string data_content_type = 4;

  // The metadata passing to pub components
  //
  // metadata property:
  // - key : the key of the message.
  map<string, string> metadata = 5;
}

// BulkPublishRequest is the message to bulk publish events to pubsub topic
message BulkPublishRequest {
  // The name of the pubsub component
  string pubsub_name = 1;

  // The pubsub topic
  string topic = 2;

  // The entries which contain the individual events and associated details to be published
  repeated BulkPublishRequestEntry entries = 3;

  // The request level metadata passing to to the pubsub components
  map<string, string> metadata = 4;
}

// BulkPublishRequestEntry is the message containing the event to be bulk published
message BulkPublishRequestEntry {
  // The request scoped unique ID referring to this message. Used to map status in response
  string entry_id = 1;

  // The event which will be pulished to the topic
  bytes event = 2;

  // The content type for the event
  string content_type = 3;

  // The event level metadata passing to the pubsub component
  map<string, string> metadata = 4;
}

// BulkPublishResponse is the message returned from a BulkPublishEvent call
message BulkPublishResponse {
  // The entries for different events that failed publish in the BulkPublishEvent call
  repeated BulkPublishResponseFailedEntry failedEntries = 1;
}

// BulkPublishResponseFailedEntry is the message containing the entryID and error of a failed event in BulkPublishEvent call
message BulkPublishResponseFailedEntry {
  // The response scoped unique ID referring to this message
  string entry_id = 1;

  // The error message if any on failure
  string error = 2;
}

// SubscribeTopicEventsRequestAlpha1 is a message containing the details for
// subscribing to a topic via streaming.
// The first message must always be the initial request. All subsequent
// messages must be event processed responses.
message SubscribeTopicEventsRequestAlpha1 {
  oneof subscribe_topic_events_request_type {
    SubscribeTopicEventsRequestInitialAlpha1 initial_request = 1;
    SubscribeTopicEventsRequestProcessedAlpha1 event_processed = 2;
  }
}

// SubscribeTopicEventsRequestInitialAlpha1 is the initial message containing
// the details for subscribing to a topic via streaming.
message SubscribeTopicEventsRequestInitialAlpha1 {
  // The name of the pubsub component
  string pubsub_name = 1;

  // The pubsub topic
  string topic = 2;

  // The metadata passing to pub components
  //
  // metadata property:
  // - key : the key of the message.
  map<string, string> metadata = 3;

  // dead_letter_topic is the topic to which messages that fail to be processed
  // are sent.
  optional string dead_letter_topic = 4;
}

// SubscribeTopicEventsRequestProcessedAlpha1 is the message containing the
// subscription to a topic.
message SubscribeTopicEventsRequestProcessedAlpha1 {
  // id is the unique identifier for the subscription request.
  string id = 1;

  // status is the result of the subscription request.
  TopicEventResponse status = 2;
}


// SubscribeTopicEventsResponseAlpha1 is a message returned from daprd
// when subscribing to a topic via streaming.
message SubscribeTopicEventsResponseAlpha1 {
  oneof subscribe_topic_events_response_type {
    SubscribeTopicEventsResponseInitialAlpha1 initial_response = 1;
    TopicEventRequest event_message = 2;
  }
}

// SubscribeTopicEventsResponseInitialAlpha1 is the initial response from daprd
// when subscribing to a topic.
message SubscribeTopicEventsResponseInitialAlpha1 {}


// InvokeBindingRequest is the message to send data to output bindings
message InvokeBindingRequest {
  // The name of the output binding to invoke.
  string name = 1;

  // The data which will be sent to output binding.
  bytes data = 2;

  // The metadata passing to output binding components
  //
  // Common metadata property:
  // - ttlInSeconds : the time to live in seconds for the message.
  //
  // If set in the binding definition will cause all messages to
  // have a default time to live. The message ttl overrides any value
  // in the binding definition.
  map<string, string> metadata = 3;

  // The name of the operation type for the binding to invoke
  string operation = 4;
}

// InvokeBindingResponse is the message returned from an output binding invocation
message InvokeBindingResponse {
  // The data which will be sent to output binding.
  bytes data = 1;

  // The metadata returned from an external system
  map<string, string> metadata = 2;
}

// GetSecretRequest is the message to get secret from secret store.
message GetSecretRequest {
  // The name of secret store.
  string store_name = 1 [json_name = "storeName"];

  // The name of secret key.
  string key = 2;

  // The metadata which will be sent to secret store components.
  map<string, string> metadata = 3;
}

// GetSecretResponse is the response message to convey the requested secret.
message GetSecretResponse {
  // data is the secret value. Some secret store, such as kubernetes secret
  // store, can save multiple secrets for single secret key.
  map<string, string> data = 1;
}

// GetBulkSecretRequest is the message to get the secrets from secret store.
message GetBulkSecretRequest {
  // The name of secret store.
  string store_name = 1 [json_name = "storeName"];

  // The metadata which will be sent to secret store components.
  map<string, string> metadata = 2;
}

// SecretResponse is a map of decrypted string/string values
message SecretResponse {
  map<string, string> secrets = 1;
}

// GetBulkSecretResponse is the response message to convey the requested secrets.
message GetBulkSecretResponse {
  // data hold the secret values. Some secret store, such as kubernetes secret
  // store, can save multiple secrets for single secret key.
  map<string, SecretResponse> data = 1;
}

// TransactionalStateOperation is the message to execute a specified operation with a key-value pair.
message TransactionalStateOperation {
  // The type of operation to be executed
  string operationType = 1;

  // State values to be operated on
  common.v1.StateItem request = 2;
}

// ExecuteStateTransactionRequest is the message to execute multiple operations on a specified store.
message ExecuteStateTransactionRequest {
  // Required. name of state store.
  string storeName = 1;

  // Required. transactional operation list.
  repeated TransactionalStateOperation operations = 2;

  // The metadata used for transactional operations.
  map<string, string> metadata = 3;
}

// RegisterActorTimerRequest is the message to register a timer for an actor of a given type and id.
message RegisterActorTimerRequest {
  string actor_type = 1 [json_name = "actorType"];
  string actor_id = 2 [json_name = "actorId"];
  string name = 3;
  string due_time = 4 [json_name = "dueTime"];
  string period = 5;
  string callback = 6;
  bytes data = 7;
  string ttl = 8;
}

// UnregisterActorTimerRequest is the message to unregister an actor timer
message UnregisterActorTimerRequest {
  string actor_type = 1 [json_name = "actorType"];
  string actor_id = 2 [json_name = "actorId"];
  string name = 3;
}

// RegisterActorReminderRequest is the message to register a reminder for an actor of a given type and id.
message RegisterActorReminderRequest {
  string actor_type = 1 [json_name = "actorType"];
  string actor_id = 2 [json_name = "actorId"];
  string name = 3;
  string due_time = 4 [json_name = "dueTime"];
  string period = 5;
  bytes data = 6;
  string ttl = 7;
}

// UnregisterActorReminderRequest is the message to unregister an actor reminder.
message UnregisterActorReminderRequest {
  string actor_type = 1 [json_name = "actorType"];
  string actor_id = 2 [json_name = "actorId"];
  string name = 3;
}

// GetActorStateRequest is the message to get key-value states from specific actor.
message GetActorStateRequest {
  string actor_type = 1 [json_name = "actorType"];
  string actor_id = 2 [json_name = "actorId"];
  string key = 3;
}

// GetActorStateResponse is the response conveying the actor's state value.
message GetActorStateResponse {
  bytes data = 1;

  // The metadata which will be sent to app.
  map<string, string> metadata = 2;
}

// ExecuteActorStateTransactionRequest is the message to execute multiple operations on a specified actor.
message ExecuteActorStateTransactionRequest {
  string actor_type = 1 [json_name = "actorType"];
  string actor_id = 2 [json_name = "actorId"];
  repeated TransactionalActorStateOperation operations = 3;
}

// TransactionalActorStateOperation is the message to execute a specified operation with a key-value pair.
message TransactionalActorStateOperation {
  string operationType = 1;
  string key = 2;
  google.protobuf.Any value = 3;
  // The metadata used for transactional operations.
  //
  // Common metadata property:
  // - ttlInSeconds : the time to live in seconds for the stored value.
  map<string, string> metadata = 4;
}

// InvokeActorRequest is the message to call an actor.
message InvokeActorRequest {
  string actor_type = 1 [json_name = "actorType"];
  string actor_id = 2 [json_name = "actorId"];
  string method = 3;
  bytes  data = 4;
  map<string, string> metadata = 5;
}

// InvokeActorResponse is the method that returns an actor invocation response.
message InvokeActorResponse {
  bytes data = 1;
}

// GetMetadataRequest is the message for the GetMetadata request.
message GetMetadataRequest {
  // Empty
}

// GetMetadataResponse is a message that is returned on GetMetadata rpc call.
message GetMetadataResponse {
  string id = 1;
  // Deprecated alias for actor_runtime.active_actors.
  repeated ActiveActorsCount active_actors_count = 2 [json_name = "actors", deprecated = true];
  repeated RegisteredComponents registered_components = 3 [json_name = "components"];
  map<string, string> extended_metadata = 4 [json_name = "extended"];
  repeated PubsubSubscription subscriptions = 5 [json_name = "subscriptions"];
  repeated MetadataHTTPEndpoint http_endpoints = 6 [json_name = "httpEndpoints"];
  AppConnectionProperties app_connection_properties = 7 [json_name = "appConnectionProperties"];
  string runtime_version = 8 [json_name = "runtimeVersion"];
  repeated string enabled_features = 9 [json_name = "enabledFeatures"];
  ActorRuntime actor_runtime = 10 [json_name = "actorRuntime"];
  optional MetadataScheduler scheduler = 11 [json_name = "scheduler"];
}

// MetadataScheduler is a message that contains the list of addresses of the
// scheduler connections.
message MetadataScheduler {
  // connected_addresses the list of addresses of the scheduler connections.
  repeated string connected_addresses = 1;
}

message ActorRuntime {
  enum ActorRuntimeStatus {
    // Indicates that the actor runtime is still being initialized.
    INITIALIZING = 0;
    // Indicates that the actor runtime is disabled.
    // This normally happens when Dapr is started without "placement-host-address"
    DISABLED = 1;
    // Indicates the actor runtime is running, either as an actor host or client.
    RUNNING = 2;
  }

  // Contains an enum indicating whether the actor runtime has been initialized.
  ActorRuntimeStatus runtime_status = 1 [json_name = "runtimeStatus"];
  // Count of active actors per type.
  repeated ActiveActorsCount active_actors = 2 [json_name = "activeActors"];
  // Indicates whether the actor runtime is ready to host actors.
  bool host_ready = 3 [json_name = "hostReady"];
  // Custom message from the placement provider.
  string placement = 4 [json_name = "placement"];
}

message ActiveActorsCount {
  string type = 1;
  int32 count = 2;
}

message RegisteredComponents {
  string name = 1;
  string type = 2;
  string version = 3;
  repeated string capabilities = 4;
}

message MetadataHTTPEndpoint {
  string name = 1 [json_name = "name"];
}

message AppConnectionProperties {
  int32 port = 1;
  string protocol = 2;
  string channel_address = 3 [json_name = "channelAddress"];
  int32 max_concurrency = 4 [json_name = "maxConcurrency"];
  AppConnectionHealthProperties health = 5;
}

message AppConnectionHealthProperties {
  string health_check_path = 1 [json_name = "healthCheckPath"];
  string health_probe_interval = 2 [json_name = "healthProbeInterval"];
  string health_probe_timeout = 3 [json_name = "healthProbeTimeout"];
  int32 health_threshold = 4 [json_name = "healthThreshold"];
}

message PubsubSubscription {
  string pubsub_name = 1 [json_name = "pubsubname"];
  string topic = 2 [json_name = "topic"];
  map<string,string> metadata = 3 [json_name = "metadata"];
  PubsubSubscriptionRules rules = 4 [json_name = "rules"];
  string dead_letter_topic = 5 [json_name = "deadLetterTopic"];
  PubsubSubscriptionType type = 6 [json_name = "type"];
}

// PubsubSubscriptionType indicates the type of subscription
enum PubsubSubscriptionType {
  // UNKNOWN is the default value for the subscription type.
  UNKNOWN = 0;
  // Declarative subscription (k8s CRD)
  DECLARATIVE = 1;
  // Programmatically created subscription
  PROGRAMMATIC = 2;
  // Bidirectional Streaming subscription
  STREAMING = 3;
}

message PubsubSubscriptionRules {
  repeated PubsubSubscriptionRule rules = 1;
}

message PubsubSubscriptionRule {
  string match = 1;
  string path = 2;
}

message SetMetadataRequest {
  string key = 1;
  string value = 2;
}

// GetConfigurationRequest is the message to get a list of key-value configuration from specified configuration store.
message GetConfigurationRequest {
  // Required. The name of configuration store.
  string store_name = 1;

  // Optional. The key of the configuration item to fetch.
  // If set, only query for the specified configuration items.
  // Empty list means fetch all.
  repeated string keys = 2;

  // Optional. The metadata which will be sent to configuration store components.
  map<string, string> metadata = 3;
}

// GetConfigurationResponse is the response conveying the list of configuration values.
// It should be the FULL configuration of specified application which contains all of its configuration items.
message GetConfigurationResponse {
  map<string, common.v1.ConfigurationItem> items = 1;
}

// SubscribeConfigurationRequest is the message to get a list of key-value configuration from specified configuration store.
message SubscribeConfigurationRequest {
  // The name of configuration store.
  string store_name = 1;

  // Optional. The key of the configuration item to fetch.
  // If set, only query for the specified configuration items.
  // Empty list means fetch all.
  repeated string keys = 2;

  // The metadata which will be sent to configuration store components.
  map<string, string> metadata = 3;
}

// UnSubscribeConfigurationRequest is the message to stop watching the key-value configuration.
message UnsubscribeConfigurationRequest {
  // The name of configuration store.
  string store_name = 1;

  // The id to unsubscribe.
  string id = 2;
}

message SubscribeConfigurationResponse {
  // Subscribe id, used to stop subscription.
  string id = 1;

  // The list of items containing configuration values
  map<string, common.v1.ConfigurationItem> items = 2;
}

message UnsubscribeConfigurationResponse {
  bool ok = 1;
  string message = 2;
}

message TryLockRequest {
  // Required. The lock store name,e.g. `redis`.
  string store_name = 1 [json_name = "storeName"];

  // Required. resource_id is the lock key. e.g. `order_id_111`
  // It stands for "which resource I want to protect"
  string resource_id = 2 [json_name = "resourceId"];

  // Required. lock_owner indicate the identifier of lock owner.
  // You can generate a uuid as lock_owner.For example,in golang:
  //
  // req.LockOwner = uuid.New().String()
  //
  // This field is per request,not per process,so it is different for each request,
  // which aims to prevent multi-thread in the same process trying the same lock concurrently.
  //
  // The reason why we don't make it automatically generated is:
  // 1. If it is automatically generated,there must be a 'my_lock_owner_id' field in the response.
  //   This name is so weird that we think it is inappropriate to put it into the api spec
  // 2. If we change the field 'my_lock_owner_id' in the response to 'lock_owner',which means the current lock owner of this lock,
  //   we find that in some lock services users can't get the current lock owner.Actually users don't need it at all.
  // 3. When reentrant lock is needed,the existing lock_owner is required to identify client and check "whether this client can reenter this lock".
  //   So this field in the request shouldn't be removed.
  string lock_owner = 3 [json_name = "lockOwner"];

  // Required. The time before expiry.The time unit is second.
  int32 expiry_in_seconds = 4 [json_name = "expiryInSeconds"];
}

message TryLockResponse {
  bool success = 1;
}

message UnlockRequest {
  string store_name = 1 [json_name = "storeName"];
  // resource_id is the lock key.
  string resource_id = 2 [json_name = "resourceId"];
  string lock_owner = 3 [json_name = "lockOwner"];
}

message UnlockResponse {
  enum Status {
    SUCCESS = 0;
    LOCK_DOES_NOT_EXIST = 1;
    LOCK_BELONGS_TO_OTHERS = 2;
    INTERNAL_ERROR = 3;
  }

  Status status = 1;
}

// SubtleGetKeyRequest is the request object for SubtleGetKeyAlpha1.
message SubtleGetKeyRequest {
  enum KeyFormat {
    // PEM (PKIX) (default)
    PEM = 0;
    // JSON (JSON Web Key) as string
    JSON = 1;
  }

  // Name of the component
  string component_name = 1 [json_name="componentName"];
  // Name (or name/version) of the key to use in the key vault
  string name = 2;
  // Response format
  KeyFormat format = 3;
}

// SubtleGetKeyResponse is the response for SubtleGetKeyAlpha1.
message SubtleGetKeyResponse {
  // Name (or name/version) of the key.
  // This is returned as response too in case there is a version.
  string name = 1;
  // Public key, encoded in the requested format
  string public_key = 2 [json_name="publicKey"];
}

// SubtleEncryptRequest is the request for SubtleEncryptAlpha1.
message SubtleEncryptRequest {
  // Name of the component
  string component_name = 1 [json_name="componentName"];
  // Message to encrypt.
  bytes plaintext = 2;
  // Algorithm to use, as in the JWA standard.
  string algorithm = 3;
  // Name (or name/version) of the key.
  string key_name = 4 [json_name="keyName"];
  // Nonce / initialization vector.
  // Ignored with asymmetric ciphers.
  bytes nonce = 5;
  // Associated Data when using AEAD ciphers (optional).
  bytes associated_data = 6 [json_name="associatedData"];
}

// SubtleEncryptResponse is the response for SubtleEncryptAlpha1.
message SubtleEncryptResponse {
  // Encrypted ciphertext.
  bytes ciphertext = 1;
  // Authentication tag.
  // This is nil when not using an authenticated cipher.
  bytes tag = 2;
}

// SubtleDecryptRequest is the request for SubtleDecryptAlpha1.
message SubtleDecryptRequest {
  // Name of the component
  string component_name = 1 [json_name="componentName"];
  // Message to decrypt.
  bytes ciphertext = 2;
  // Algorithm to use, as in the JWA standard.
  string algorithm = 3;
  // Name (or name/version) of the key.
  string key_name = 4 [json_name="keyName"];
  // Nonce / initialization vector.
  // Ignored with asymmetric ciphers.
  bytes nonce = 5;
  // Authentication tag.
  // This is nil when not using an authenticated cipher.
  bytes tag = 6;
  // Associated Data when using AEAD ciphers (optional).
  bytes associated_data = 7 [json_name="associatedData"];
}

// SubtleDecryptResponse is the response for SubtleDecryptAlpha1.
message SubtleDecryptResponse {
  // Decrypted plaintext.
  bytes plaintext = 1;
}

// SubtleWrapKeyRequest is the request for SubtleWrapKeyAlpha1.
message SubtleWrapKeyRequest {
  // Name of the component
  string component_name = 1 [json_name="componentName"];
  // Key to wrap
  bytes plaintext_key = 2 [json_name="plaintextKey"];
  // Algorithm to use, as in the JWA standard.
  string algorithm = 3;
  // Name (or name/version) of the key.
  string key_name = 4 [json_name="keyName"];
  // Nonce / initialization vector.
  // Ignored with asymmetric ciphers.
  bytes nonce = 5;
  // Associated Data when using AEAD ciphers (optional).
  bytes associated_data = 6 [json_name="associatedData"];
}

// SubtleWrapKeyResponse is the response for SubtleWrapKeyAlpha1.
message SubtleWrapKeyResponse {
  // Wrapped key.
  bytes wrapped_key = 1 [json_name="wrappedKey"];
  // Authentication tag.
  // This is nil when not using an authenticated cipher.
  bytes tag = 2;
}

// SubtleUnwrapKeyRequest is the request for SubtleUnwrapKeyAlpha1.
message SubtleUnwrapKeyRequest {
  // Name of the component
  string component_name = 1 [json_name="componentName"];
  // Wrapped key.
  bytes wrapped_key = 2 [json_name="wrappedKey"];
  // Algorithm to use, as in the JWA standard.
  string algorithm = 3;
  // Name (or name/version) of the key.
  string key_name = 4 [json_name="keyName"];
  // Nonce / initialization vector.
  // Ignored with asymmetric ciphers.
  bytes nonce = 5;
  // Authentication tag.
  // This is nil when not using an authenticated cipher.
  bytes tag = 6;
  // Associated Data when using AEAD ciphers (optional).
  bytes associated_data = 7 [json_name="associatedData"];
}

// SubtleUnwrapKeyResponse is the response for SubtleUnwrapKeyAlpha1.
message SubtleUnwrapKeyResponse {
  // Key in plaintext
  bytes plaintext_key = 1 [json_name="plaintextKey"];
}

// SubtleSignRequest is the request for SubtleSignAlpha1.
message SubtleSignRequest {
  // Name of the component
  string component_name = 1 [json_name="componentName"];
  // Digest to sign.
  bytes digest = 2;
  // Algorithm to use, as in the JWA standard.
  string algorithm = 3;
  // Name (or name/version) of the key.
  string key_name = 4 [json_name="keyName"];
}

// SubtleSignResponse is the response for SubtleSignAlpha1.
message SubtleSignResponse {
  // The signature that was computed
  bytes signature = 1;
}

// SubtleVerifyRequest is the request for SubtleVerifyAlpha1.
message SubtleVerifyRequest {
  // Name of the component
  string component_name = 1 [json_name="componentName"];
  // Digest of the message.
  bytes digest = 2;
  // Algorithm to use, as in the JWA standard.
  string algorithm = 3;
  // Name (or name/version) of the key.
  string key_name = 4 [json_name="keyName"];
  // Signature to verify.
  bytes signature = 5;
}

// SubtleVerifyResponse is the response for SubtleVerifyAlpha1.
message SubtleVerifyResponse {
  // True if the signature is valid.
  bool valid = 1;
}

// EncryptRequest is the request for EncryptAlpha1.
message EncryptRequest {
  // Request details. Must be present in the first message only.
  EncryptRequestOptions options = 1;
  // Chunk of data of arbitrary size.
  common.v1.StreamPayload payload = 2;
}

// EncryptRequestOptions contains options for the first message in the EncryptAlpha1 request.
message EncryptRequestOptions {
  // Name of the component. Required.
  string component_name = 1 [json_name="componentName"];
  // Name (or name/version) of the key. Required.
  string key_name = 2 [json_name="keyName"];
  // Key wrapping algorithm to use. Required.
  // Supported options include: A256KW (alias: AES), A128CBC, A192CBC, A256CBC, RSA-OAEP-256 (alias: RSA).
  string key_wrap_algorithm = 3;
  // Cipher used to encrypt data (optional): "aes-gcm" (default) or "chacha20-poly1305"
  string data_encryption_cipher = 10;
  // If true, the encrypted document does not contain a key reference.
  // In that case, calls to the Decrypt method must provide a key reference (name or name/version).
  // Defaults to false.
  bool omit_decryption_key_name = 11 [json_name="omitDecryptionKeyName"];
  // Key reference to embed in the encrypted document (name or name/version).
  // This is helpful if the reference of the key used to decrypt the document is different from the one used to encrypt it.
  // If unset, uses the reference of the key used to encrypt the document (this is the default behavior).
  // This option is ignored if omit_decryption_key_name is true.
  string decryption_key_name = 12 [json_name="decryptionKeyName"];
}

// EncryptResponse is the response for EncryptAlpha1.
message EncryptResponse {
  // Chunk of data.
  common.v1.StreamPayload payload = 1;
}

// DecryptRequest is the request for DecryptAlpha1.
message DecryptRequest {
  // Request details. Must be present in the first message only.
  DecryptRequestOptions options = 1;
  // Chunk of data of arbitrary size.
  common.v1.StreamPayload payload = 2;
}

// DecryptRequestOptions contains options for the first message in the DecryptAlpha1 request.
message DecryptRequestOptions {
  // Name of the component
  string component_name = 1 [json_name="componentName"];
  // Name (or name/version) of the key to decrypt the message.
  // Overrides any key reference included in the message if present.
  // This is required if the message doesn't include a key reference (i.e. was created with omit_decryption_key_name set to true).
  string key_name = 12 [json_name="keyName"];
}

// DecryptResponse is the response for DecryptAlpha1.
message DecryptResponse {
  // Chunk of data.
  common.v1.StreamPayload payload = 1;
}

// GetWorkflowRequest is the request for GetWorkflowBeta1.
message GetWorkflowRequest {
  // ID of the workflow instance to query.
  string instance_id  = 1 [json_name = "instanceID"];
  // Name of the workflow component.
  string workflow_component = 2 [json_name = "workflowComponent"];
}

// GetWorkflowResponse is the response for GetWorkflowBeta1.
message GetWorkflowResponse {
  // ID of the workflow instance.
  string instance_id = 1 [json_name = "instanceID"];
  // Name of the workflow.
  string workflow_name = 2 [json_name = "workflowName"];
  // The time at which the workflow instance was created.
  google.protobuf.Timestamp created_at = 3 [json_name = "createdAt"];
  // The last time at which the workflow instance had its state changed.
  google.protobuf.Timestamp last_updated_at = 4 [json_name = "lastUpdatedAt"];
  // The current status of the workflow instance, for example, "PENDING", "RUNNING", "SUSPENDED", "COMPLETED", "FAILED", and "TERMINATED".
  string runtime_status = 5 [json_name = "runtimeStatus"];
  // Additional component-specific properties of the workflow instance.
  map<string, string> properties = 6;
}

// StartWorkflowRequest is the request for StartWorkflowBeta1.
message StartWorkflowRequest {
  // The ID to assign to the started workflow instance. If empty, a random ID is generated.
  string instance_id = 1 [json_name = "instanceID"];
  // Name of the workflow component.
  string workflow_component = 2 [json_name = "workflowComponent"];
  // Name of the workflow.
  string workflow_name = 3 [json_name = "workflowName"];
  // Additional component-specific options for starting the workflow instance.
  map<string, string> options = 4;
  // Input data for the workflow instance.
  bytes input = 5;
}

// StartWorkflowResponse is the response for StartWorkflowBeta1.
message StartWorkflowResponse {
  // ID of the started workflow instance.
  string instance_id = 1 [json_name = "instanceID"];
}

// TerminateWorkflowRequest is the request for TerminateWorkflowBeta1.
message TerminateWorkflowRequest {
  // ID of the workflow instance to terminate.
  string instance_id = 1 [json_name = "instanceID"];
  // Name of the workflow component.
  string workflow_component = 2 [json_name = "workflowComponent"];
}

// PauseWorkflowRequest is the request for PauseWorkflowBeta1.
message PauseWorkflowRequest {
  // ID of the workflow instance to pause.
  string instance_id = 1 [json_name = "instanceID"];
  // Name of the workflow component.
  string workflow_component = 2 [json_name = "workflowComponent"];
}

// ResumeWorkflowRequest is the request for ResumeWorkflowBeta1.
message ResumeWorkflowRequest {
  // ID of the workflow instance to resume.
  string instance_id = 1 [json_name = "instanceID"];
  // Name of the workflow component.
  string workflow_component = 2 [json_name = "workflowComponent"];
}

// RaiseEventWorkflowRequest is the request for RaiseEventWorkflowBeta1.
message RaiseEventWorkflowRequest {
  // ID of the workflow instance to raise an event for.
  string instance_id = 1 [json_name = "instanceID"];
  // Name of the workflow component.
  string workflow_component = 2 [json_name = "workflowComponent"];
  // Name of the event.
  string event_name = 3 [json_name = "eventName"];
  // Data associated with the event.
  bytes event_data = 4;
}

// PurgeWorkflowRequest is the request for PurgeWorkflowBeta1.
message PurgeWorkflowRequest {
  // ID of the workflow instance to purge.
  string instance_id = 1 [json_name = "instanceID"];
  // Name of the workflow component.
  string workflow_component = 2 [json_name = "workflowComponent"];
}

// ShutdownRequest is the request for Shutdown.
message ShutdownRequest {
  // Empty
}

// Job is the definition of a job. At least one of schedule or due_time must be
// provided but can also be provided together.
message Job {
  // The unique name for the job.
  string name = 1 [json_name = "name"];

  // schedule is an optional schedule at which the job is to be run.
  // Accepts both systemd timer style cron expressions, as well as human
  // readable '@' prefixed period strings as defined below.
  //
  // Systemd timer style cron accepts 6 fields:
  // seconds | minutes | hours | day of month | month        | day of week
  // 0-59    | 0-59    | 0-23  | 1-31         | 1-12/jan-dec | 0-6/sun-sat
  //
  // "0 30 * * * *" - every hour on the half hour
  // "0 15 3 * * *" - every day at 03:15
  //
  // Period string expressions:
	// Entry                  | Description                                  | Equivalent To
	// -----                  | -----------                                  | -------------
  // @every `<duration>`    | Run every `<duration>` (e.g. '@every 1h30m') | N/A
	// @yearly (or @annually) | Run once a year, midnight, Jan. 1st          | 0 0 0 1 1 *
	// @monthly               | Run once a month, midnight, first of month   | 0 0 0 1 * *
	// @weekly                | Run once a week, midnight on Sunday          | 0 0 0 * * 0
	// @daily (or @midnight)  | Run once a day, midnight                     | 0 0 0 * * *
	// @hourly                | Run once an hour, beginning of hour          | 0 0 * * * *
  optional string schedule = 2 [json_name = "schedule"];

  // repeats is the optional number of times in which the job should be
  // triggered. If not set, the job will run indefinitely or until expiration.
  optional uint32 repeats = 3 [json_name = "repeats"];

  // due_time is the optional time at which the job should be active, or the
  // "one shot" time if other scheduling type fields are not provided. Accepts
  // a "point in time" string in the format of RFC3339, Go duration string
  // (calculated from job creation time), or non-repeating ISO8601.
  optional string due_time = 4 [json_name = "dueTime"];

  // ttl is the optional time to live or expiration of the job. Accepts a
  // "point in time" string in the format of RFC3339, Go duration string
  // (calculated from job creation time), or non-repeating ISO8601.
  optional string ttl = 5 [json_name = "ttl"];

  // payload is the serialized job payload that will be sent to the recipient
  // when the job is triggered.
  google.protobuf.Any data = 6 [json_name = "data"];

  // failure_policy is the optional policy for handling job failures.
  optional common.v1.JobFailurePolicy failure_policy = 7 [json_name = "failurePolicy"];
}

// ScheduleJobRequest is the message to create/schedule the job.
message ScheduleJobRequest {
  // The job details.
  Job job = 1;
  // If true, allows this job to overwrite an existing job with the same name.
  bool overwrite = 2  [json_name = "overwrite"];
}

// ScheduleJobResponse is the message response to create/schedule the job.
message ScheduleJobResponse {
  // Empty
}

// GetJobRequest is the message to retrieve a job.
message GetJobRequest {
  // The name of the job.
  string name = 1;
}

// GetJobResponse is the message's response for a job retrieved.
message GetJobResponse {
  // The job details.
  Job job = 1;
}

// DeleteJobRequest is the message to delete the job by name.
message DeleteJobRequest {
  // The name of the job.
  string name = 1;
}

// DeleteJobResponse is the message response to delete the job by name.
message DeleteJobResponse {
  // Empty
}

// ConversationRequest is the request object for Conversation.
message ConversationRequest {
  option deprecated = true;
  
  // The name of Conversation component
  string name = 1;

  // The ID of an existing chat (like in ChatGPT)
  optional string contextID = 2;

  // Inputs for the conversation, support multiple input in one time.
  repeated ConversationInput inputs = 3;

  // Parameters for all custom fields.
  map<string, google.protobuf.Any> parameters = 4;

  // The metadata passing to conversation components.
  map<string, string> metadata = 5;

  // Scrub PII data that comes back from the LLM
  optional bool scrubPII = 6;

  // Temperature for the LLM to optimize for creativity or predictability
  optional double temperature = 7;
}

// ConversationRequestAlpha2 is the new request object for Conversation.
// Many of these fields are inspired by openai.ChatCompletionNewParams
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L2106
message ConversationRequestAlpha2 {
  // The name of Conversation component
  string name = 1;

  // The ID of an existing chat (like in ChatGPT)
  optional string context_id = 2;

  // Inputs for the conversation, support multiple input in one time.
  // This is the revamped conversation inputs better matching openai.
  repeated ConversationInputAlpha2 inputs = 3;

  // Parameters for all custom fields.
  map<string, google.protobuf.Any> parameters = 4;

  // The metadata passing to conversation components.
  map<string, string> metadata = 5;

  // Scrub PII data that comes back from the LLM
  optional bool scrub_pii = 6;

  // Temperature for the LLM to optimize for creativity or predictability
  optional double temperature = 7;

  // Tools register the tools available to be used by the LLM during the conversation.
  // These are sent on a per request basis.
  // The tools available during the first round of the conversation
  // may be different than tools specified later on.
  repeated ConversationTools tools = 8;

  // Controls which (if any) tool is called by the model. 
  // `none` means the model will not call any tool and instead generates a message. 
  // `auto` means the model can pick between generating a message or calling one or more tools.
  // Alternatively, a specific tool name may be used here, and casing/syntax must match on tool name.
  // `none` is the default when no tools are present.
  // `auto` is the default if tools are present.
  // `required` requires one or more functions to be called.
  // ref: https://github.com/openai/openai-go/blob/main/chatcompletion.go#L1976
  // ref: https://python.langchain.com/docs/how_to/tool_choice/
  optional string tool_choice = 9;

  /* TODO: fields to bring in from openai.ChatCompletionNewParams after Dapr 1.16.
  Note: They can be within the other messages, not necessarily top level here.
  MaxCompletionTokens: https://github.com/openai/openai-go/blob/main/chatcompletion.go#L2131
  Audio: https://github.com/openai/openai-go/blob/main/chatcompletion.go#L2186
  Modalities: https://github.com/openai/openai-go/blob/main/chatcompletion.go#L2215
  ReasoningEffort: https://github.com/openai/openai-go/blob/main/chatcompletion.go#L2224
  Stop: https://github.com/openai/openai-go/blob/main/chatcompletion.go#L2249 <----------------should we bring this in?
  StreamOptions: https://github.com/openai/openai-go/blob/main/chatcompletion.go#L2251
  ResponseFormat: https://github.com/openai/openai-go/blob/main/chatcompletion.go#L2284
  */
}

// maintained for backwards compatibility
message ConversationInput {
  option deprecated = true;

  // The content to send to the llm
  string content = 1;

  // The role to set for the message
  optional string role = 2;

  // Scrub PII data that goes into the LLM
  optional bool scrubPII = 3;
}

// directly inspired by openai.ChatCompletionNewParams
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L2106
message ConversationInputAlpha2 {
  // The content to send to the llm
  repeated ConversationMessage messages = 1;

  // Scrub PII data that goes into the LLM
  optional bool scrub_pii = 2;
}

// inspired by openai.ChatCompletionMessageParamUnion
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L1449
// The role field is inherent to the type of ConversationMessage,
// and is propagated in the backend according to the underlying LLM provider type.
message ConversationMessage {
  oneof message_types {
    ConversationMessageOfDeveloper of_developer = 1;
    ConversationMessageOfSystem of_system = 2;
    ConversationMessageOfUser of_user = 3;
    ConversationMessageOfAssistant of_assistant = 4;
    ConversationMessageOfTool of_tool = 5; 
    // Note: there could be a ConversationMessageOfFunction type here too, 
    // but that is deprecated in openai, so we will not support this.
  }
}

// inspired by openai.ChatCompletionDeveloperMessageParam
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L1130
// ConversationMessageOfDeveloper is intended to be the contents of a conversation message,
// as the role of a developer.
message ConversationMessageOfDeveloper {
  // The name of the participant in the message.
  optional string name = 1;
  repeated ConversationMessageContent content = 2;
}

// inspired by openai.ChatCompletionSystemMessageParam
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L1842
// ConversationMessageOfSystem is intended to be the contents of a conversation message,
// as the role of a system.
message ConversationMessageOfSystem {
  optional string name = 1;
  repeated ConversationMessageContent content = 2;
}

// inspired by openai.ChatCompletionUserMessageParam
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L2060C6-L2060C36
// ConversationMessageOfUser is intended to be the contents of a conversation message,
// as the role of an end user.
message ConversationMessageOfUser {
  optional string name = 1;
  repeated ConversationMessageContent content = 2;
}

// inspired by openai.ChatCompletionAssistantMessageParam
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L310
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L2060C6-L2060C36
// ConversationMessageOfAssistant is intended to be the contents of a conversation message,
// as the role of an assistant.
message ConversationMessageOfAssistant {
  optional string name = 1;

  // TODO: there is an audio field here to bring in when the time comes 1.17 or later.

  repeated ConversationMessageContent content = 2;

  // Tool calls generated by the model, such as function calls for the client to then make.
  repeated ConversationToolCalls tool_calls = 3;

  // TODO: after 1.16 there is a refusal field that openai has here,
  // but langchain does not have support for this yet,
  // so we do not add to our api.

  // Note: There is a FunctionCall type too that is deprecated,
  // so we are not bringing that to dapr.
}

// inspired by openai.ChatCompletionToolMessageParam
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L2011
// ConversationMessageOfTool is intended to be the contents of a conversation message,
// as the role of a tool.
message ConversationMessageOfTool {
  // Tool ID is helpful for tracking tool history
  optional string tool_id = 1;

  // Name of tool associated with the message
  string name = 2;

  repeated ConversationMessageContent content = 3;

}

// inspired by openai.ChatCompletionMessageToolCallParam and openai.ChatCompletionMessageToolCall
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L1669
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L1611
// ConversationToolCalls is the tool call request sent from the llm to the client to then call to execute.
// This assumes that in our api if a client makes a request that would get a tool call response from the llm,
// that this client can also have the tool handy itself to execute it.
message ConversationToolCalls {
  optional string id = 1;
  oneof tool_types {
      ConversationToolCallsOfFunction function = 2;
  }
}

// inspired by openai.ChatCompletionMessageToolCallFunctionParam
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L1692
message ConversationToolCallsOfFunction {
  string name = 1;
  // The arguments to call the function with, as generated by the model in JSON
  // format. Note that the model does not always generate valid JSON, and may
  // hallucinate parameters not defined by your function schema. Validate the
  // arguments in your code before calling your function.
  string arguments = 2;
}

// inspired by openai.ChatCompletionContentPartTextParam & openai.ChatCompletionDeveloperMessageParamContentUnion
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L1084
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L1154C6-L1154C53
// Note: openai has this message be either a message of string or message of array type,
// so instead of this, we support that in one message type instead.
message ConversationMessageContent {
  string text = 1;
}

// ConversationResult is the result for one input.
message ConversationResult {
  option deprecated = true;

  // Result for the one conversation input.
  string result = 1;
  // Parameters for all custom fields.
  map<string, google.protobuf.Any> parameters = 2;
}

// inspired by openai.ChatCompletion
// ConversationResultAlpha2 is the result for one input.
message ConversationResultAlpha2 {
  // Result for the conversation input.
  repeated ConversationResultChoices choices = 1;

  /* TODO bring in for 1.17 based on openai
  https://github.com/openai/openai-go/blob/main/chatcompletion.go#L166
  Usage https://github.com/openai/openai-go/blob/main/chatcompletion.go#L204

  Bring in 1.16:
  Created (timestamp): https://github.com/openai/openai-go/blob/main/chatcompletion.go#L173
  Model: https://github.com/openai/openai-go/blob/main/chatcompletion.go#L175
  */
}

// inspired by openai.ChatCompletionChoice
// based on https://github.com/openai/openai-go/blob/main/chatcompletion.go#L226
message ConversationResultChoices {
  // The reason the model stopped generating tokens. This will be `stop` if the model
  // hit a natural stop point or a provided stop sequence, `length` if the maximum
  // number of tokens specified in the request was reached, `content_filter` if
  // content was omitted due to a flag from our content filters, `tool_calls` if the
  // model called a tool.
  // Any of "stop", "length", "tool_calls", "content_filter".
  string finish_reason = 1;

  // The index of the choice in the list of choices.
  int64 index = 2;

  ConversationResultMessage message = 3;
}

// inspired by openai.ChatCompletionMessage
// based on https://github.com/openai/openai-go/blob/main/chatcompletion.go#L1218C6-L1218C27
message ConversationResultMessage {
  // The contents of the message.
  string content = 1;
  // The tool calls generated by the model.
  repeated ConversationToolCalls tool_calls = 2;

  // TODO: after 1.16 there is a refusal field that openai has here,
  // but langchain does not have support for this yet,
  // so we do not add to our api.
}

// ConversationResponse is the response for Conversation.
message ConversationResponse {
  option deprecated = true;

  // The ID of an existing chat (like in ChatGPT)
  optional string contextID = 1;

  // An array of results.
  repeated ConversationResult outputs = 2;
}

// ConversationResponseAlpha2 is the Alpha2 response for Conversation.
message ConversationResponseAlpha2 {
  // The ID of an existing chat (like in ChatGPT)
  optional string context_id = 1;

  // An array of results.
  repeated ConversationResultAlpha2 outputs = 2;
}

// ConversationTools are the typed tools available to be called.
// inspired by openai.ChatCompletionToolParam
// https://github.com/openai/openai-go/blob/main/chatcompletion.go#L1950
message ConversationTools {
  oneof tool_types {
    ConversationToolsFunction function = 1;
  }
}

// ConversationToolsFunction is the main tool type to be used in a conversation.
// inspired by openai.FunctionDefinitionParam
// https://pkg.go.dev/github.com/openai/openai-go/shared#FunctionDefinitionParam
message ConversationToolsFunction {
  // The name of the function to be called.
  string name = 1;

  // A description of what the function does, 
  // used by the model to choose when and how to call the function.
  optional string description = 2;

  // The parameters the functions accepts, described as a JSON Schema object. 
  // See the [guide](https://platform.openai.com/docs/guides/function-calling) for examples,
  // and the [JSON Schema reference](https://json-schema.org/understanding-json-schema/) for documentation about the format.
  // Omitting `parameters` defines a function with an empty parameter list.
  google.protobuf.Struct parameters = 3;
}
