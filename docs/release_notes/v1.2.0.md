
# Dapr 1.2.0

We're happy to announce the release of Dapr 1.2.0!

We would like to extend our thanks to all the new and existing contributors who helped make this release happen.

**Highlights**

If you're new to Dapr, visit the [getting started](https://docs.dapr.io/getting-started/) page and familiarize yourself with Dapr.

Docs have been updated with all the new features and changes of this release. To get started with new capabilities introduced in this release, go to the [Concepts](https://v1-2.docs.dapr.io/concepts/) and the [Developing applications](https://v1-2.docs.dapr.io/developing-applications/).



See [this](#Upgrading-to-Dapr-120) section on upgrading Dapr to version 1.2.0.

## Acknowledgements

Thanks to everyone who made this release possible!

@0to1, @1046102779, @AaronCrawfis, @DarqueWarrior, @EdwinVW, @Hugome, @JoeMayo, @Junnplus, @Taction, @TomorJM, @a-elsheikh, @abogdanov37, @akkie, @apuzyrevsky, @artursouza, @beiwei30, @berndverst, @cinience, @fjvela, @halspang, @jigargandhi, @jjcollinge, @jony4, @luckyxiaoqiang, @marviniter, @msfussell, @mukundansundar, @newbe36524, @pkedy, @readefries, @wcs1only, @withinboredom, @xiazuojie, @yanjianlong, @yaron2, @zhongfox

## New in this release

### Dapr Runtime
- **RESOLVED** Allow Reentrancy for Actors [21](https://github.com/dapr/dapr/issues/21)
- **RESOLVED** Propogate context to PubSub handler call [1721](https://github.com/dapr/dapr/issues/1721)
- **RESOLVED** Add context to PubSub handler  [1749](https://github.com/dapr/dapr/pull/1749)
- **RESOLVED** Enhance pub/sub cloud event handling to support existing messaging infrastructure [2308](https://github.com/dapr/dapr/issues/2308)
- **RESOLVED** Fix E2E for SDKs on Windows [2695](https://github.com/dapr/dapr/issues/2695)
- **RESOLVED** Create a dapr/kit repo to contain common packages [2820](https://github.com/dapr/dapr/issues/2820)
- **RESOLVED** Dapr Serialization Error with Dapr CLI Publish [2925](https://github.com/dapr/dapr/issues/2925)
- **RESOLVED** Refactoring codes of getting app configuration from user application [2927](https://github.com/dapr/dapr/pull/2927)
- **RESOLVED** Running a local gRPC with TLS service fails [2963](https://github.com/dapr/dapr/issues/2963)
- **RESOLVED** Default components of Self-hosted mode miss the required version field [2964](https://github.com/dapr/dapr/issues/2964)
- **RESOLVED** Allow concurrent reconciliation of Kubernetes resources [2993](https://github.com/dapr/dapr/issues/2993)
- **RESOLVED** Increase verbosity for actor errors. [3001](https://github.com/dapr/dapr/pull/3001)
- **ADDED** audit log to sidecar injector [3009](https://github.com/dapr/dapr/issues/3009)
- **RESOLVED** [E2E Test] Public endpoint closing connection [3025](https://github.com/dapr/dapr/issues/3025)
- **RESOLVED** [E2E Test] Sidecar injection delay [3026](https://github.com/dapr/dapr/issues/3026)
- **RESOLVED** [E2E Test] Kubernetes Job does not complete [3027](https://github.com/dapr/dapr/issues/3027)
- **RESOLVED** [E2E Test] Pubsub failures [3030](https://github.com/dapr/dapr/issues/3030)
- **RESOLVED** [E2E Test] Binding failures  [3031](https://github.com/dapr/dapr/issues/3031)
- **RESOLVED** Saves perf test results for all tests. [3041](https://github.com/dapr/dapr/pull/3041)
- **RESOLVED** Perf actor reminder registration [3043](https://github.com/dapr/dapr/pull/3043)
- **ADDED** Opt-in for preview features [3048](https://github.com/dapr/dapr/issues/3048)
- **RESOLVED** optimize: directly use default metrics register [3053](https://github.com/dapr/dapr/pull/3053)
- **RESOLVED** Allow choosing which APIs are available on a sidecar [3054](https://github.com/dapr/dapr/issues/3054)
- **RESOLVED** Dapr sidecar failed to start: certificate has expired or is not yet valid [3058](https://github.com/dapr/dapr/issues/3058)
- **FIXED** Bug in runtime. [3063](https://github.com/dapr/dapr/issues/3063)
- **ADDED** Reentrancy bypass for actor locks [3078](https://github.com/dapr/dapr/issues/3078)
- **RESOLVED** operator exited with status 1 but no error log output [3082](https://github.com/dapr/dapr/issues/3082)
- **RESOLVED** Enable Dapr sidecars to pick up newly added components without restart [3085](https://github.com/dapr/dapr/issues/3085)
- **RESOLVED** Automatically merges and updates PRs. [3105](https://github.com/dapr/dapr/pull/3105)
- **ADDED**  nodeselector option in helm chart [3113](https://github.com/dapr/dapr/issues/3113)
- **RESOLVED** Fix sidecar check for e2e test apps with IngressEnabled=false [3139](https://github.com/dapr/dapr/pull/3139)
- **RESOLVED** issue: use normalizeOperation necessity [3142](https://github.com/dapr/dapr/issues/3142)
- **RESOLVED** gracefully stop runtime when exited with log.Fatalf [3159](https://github.com/dapr/dapr/issues/3159)
- **RESOLVED** service that owner referencing with a deployment will be removed [3181](https://github.com/dapr/dapr/issues/3181)
### Dapr CLI
- **UPDATED** CLI logging output to remove extra newlines when application output contains a newline [616](https://github.com/dapr/cli/issues/616)
- **RESOLVED** Permission Denied When Installing on MacBook M1 [634](https://github.com/dapr/cli/issues/634)
- **RESOLVED** Default components of Self-hosted mode miss the required version field [644](https://github.com/dapr/cli/issues/644)
- **RESOLVED** Stop the running `daprd` process on error when `dapr run` is called [645](https://github.com/dapr/cli/issues/645)
- **ADDED** Support to  get api response and replace base download URL [647](https://github.com/dapr/cli/issues/647)
- **RESOLVED** CLI `run` detects shutdown API call and exits as expected [654](https://github.com/dapr/cli/issues/654)
- **RESOLVED** MTLS automatically enabled on running `dapr upgrade` on a cluster with MTLS disabled [664](https://github.com/dapr/cli/issues/664)
- **UPDATED** Switch CLI to use Go 1.16 version [666](https://github.com/dapr/cli/issues/666)
- **ADDED** Read invoke and publish payloads from file [668](https://github.com/dapr/cli/issues/668)
- **RESOLVED** MTLS command on error exits with success [671](https://github.com/dapr/cli/issues/671)
- **RESOLVED** Update helm client. [679](https://github.com/dapr/cli/pull/679)
- **RESOLVED** Added `--dapr-http-max-request-size` parameter to CLI  [699](https://github.com/dapr/cli/issues/699)
### Components
- **RESOLVED** Support of Azure Blob Metadata (for Blob state storage) [462](https://github.com/dapr/components-contrib/issues/462)
- **RESOLVED** Add DNS name resolver. Add unit tests. [743](https://github.com/dapr/components-contrib/pull/743)
- **FIXED** Password configuration for Redis Sentinel state store. [756](https://github.com/dapr/components-contrib/issues/756)
- **UPDATED** Performance improvements [781](https://github.com/dapr/components-contrib/issues/781)
- **RESOLVED** Update Readme.md [789](https://github.com/dapr/components-contrib/pull/789)
- **RESOLVED** Fixed bug where default vaultaddr is never used. [791](https://github.com/dapr/components-contrib/pull/791)
- **RESOLVED** customize cluster domain of k8s nameresolution [792](https://github.com/dapr/components-contrib/issues/792)
- **RESOLVED** Hashicorp Vault - accept root token as string instead of file [794](https://github.com/dapr/components-contrib/issues/794)
- **RESOLVED** Use `go mod tidy` before make [799](https://github.com/dapr/components-contrib/pull/799)
- **RESOLVED** Upgrade redis client to v8 and use context in redis pubsub component to cancel request [804](https://github.com/dapr/components-contrib/pull/804)
- **RESOLVED** Implement bindings for the Zeebe workflow engine [805](https://github.com/dapr/components-contrib/issues/805)
- **RESOLVED** Implement bindings for the Zeebe workflow engine [806](https://github.com/dapr/components-contrib/pull/806)
- **RESOLVED** Error amqp:link:detach-forced [809](https://github.com/dapr/components-contrib/issues/809)
- **RESOLVED** Alibaba Cloud DingTalk Webhook Binding [811](https://github.com/dapr/components-contrib/issues/811)
- **RESOLVED** Add bindings nacos [814](https://github.com/dapr/components-contrib/pull/814)
- **RESOLVED** Add bindings rocketmq [815](https://github.com/dapr/components-contrib/pull/815)
- **RESOLVED** Add pubsub rocketmq [816](https://github.com/dapr/components-contrib/pull/816)
- **RESOLVED** Add redis cluter mode for pubsub [823](https://github.com/dapr/components-contrib/pull/823)
- **RESOLVED** optimize(state/redis): output detail redis error [825](https://github.com/dapr/components-contrib/pull/825)
- **RESOLVED** Sentinel as Dapr's middleware [828](https://github.com/dapr/components-contrib/issues/828)
- **RESOLVED** Add timeout to cancel request for it would be redelivered [832](https://github.com/dapr/components-contrib/pull/832)
- **RESOLVED** Add optional metadata param maxLen for redis stream PubSub component [835](https://github.com/dapr/components-contrib/pull/835)
- **RESOLVED** add BulkGetResponse comments [845](https://github.com/dapr/components-contrib/pull/845)
- **FIXED** Redis subscriber should not block infinitely on XReadGroup [852](https://github.com/dapr/components-contrib/issues/852)
- **RESOLVED** Make the retry package available to use across all components [853](https://github.com/dapr/components-contrib/issues/853)
- **RESOLVED** Dapr CLI commands take ~5 seconds to execute [865](https://github.com/dapr/components-contrib/issues/865)
- **RESOLVED** Update Aerospike to v4.5.0 [866](https://github.com/dapr/components-contrib/pull/866)
- Fix race in pulsar pubsub component. [867](https://github.com/dapr/components-contrib/issues/867)
### .NET SDK
- **RESOLVED** Add method for health check in dapr client [640](https://github.com/dapr/dotnet-sdk/issues/640)
### Java SDK
- **RESOLVED** Integration test for W3C tracing [394](https://github.com/dapr/java-sdk/issues/394)
- **RESOLVED** Replace all console pngs for text in examples' READMEs [466](https://github.com/dapr/java-sdk/issues/466)
- **RESOLVED** Add auto validation for Tracing Example [469](https://github.com/dapr/java-sdk/issues/469)
- **RESOLVED** protoc-jar-maven-plugin is a dependency for dapr-sdk-autogen [501](https://github.com/dapr/java-sdk/issues/501)
- **RESOLVED** Potential issue in io.dapr.client.DaprClientHttp#executeStateTransaction [514](https://github.com/dapr/java-sdk/issues/514)
- **RESOLVED** Return empty metadata for key not found + add IT test. [528](https://github.com/dapr/java-sdk/pull/528)
- **RESOLVED** Add Shutdown API  [529](https://github.com/dapr/java-sdk/issues/529)
- **RESOLVED** Update PubSub example to include tracing [537](https://github.com/dapr/java-sdk/issues/537)
### Python SDK
- **RESOLVED** Chore: remove invalid args comment [215](https://github.com/dapr/python-sdk/pull/215)
### PHP SDK
- **RESOLVED** Add Laravel example [84](https://github.com/dapr/php-sdk/pull/84)
### Documentation
- **RESOLVED** Add docs on how to use daprd and command line options [378](https://github.com/dapr/docs/issues/378)
- **RESOLVED** Add to Actor Conceptual docs [804](https://github.com/dapr/docs/issues/804)
- **RESOLVED** Create FAQ/Troubleshooting on local mDNS [1173](https://github.com/dapr/docs/issues/1173)
- **RESOLVED** Actor concepts missing types and ids [1298](https://github.com/dapr/docs/issues/1298)
- **RESOLVED** Article needed to link to Azure APIM [1303](https://github.com/dapr/docs/issues/1303)
- **RESOLVED** Outdated instructions for running Kafka on Kubernetes [1327](https://github.com/dapr/docs/issues/1327)
- **RESOLVED** chore: add documentation on the binding mqtt based on the pubsub mqtt… [1328](https://github.com/dapr/docs/pull/1328)
- **RESOLVED** [CONTENT] PubSub add more redis client settings [1339](https://github.com/dapr/docs/issues/1339)
- **RESOLVED** Update HashiCorp Vault secret docs [1354](https://github.com/dapr/docs/issues/1354)
- **RESOLVED** Update hashicorp-vault.md [1355](https://github.com/dapr/docs/pull/1355)
- **RESOLVED** Add documentation for PowerShell and Command Prompt [1373](https://github.com/dapr/docs/issues/1373)
- **RESOLVED** Remove workaround for mTLS bug [1387](https://github.com/dapr/docs/issues/1387)
- **RESOLVED** [CONTENT] Add CLI reference docs for `--data-file` flags for invoke and publish [1391](https://github.com/dapr/docs/issues/1391)
- **RESOLVED** Add Alibaba Cloud Nacos binding Doc [1401](https://github.com/dapr/docs/pull/1401)
- **RESOLVED** Add Alibaba Cloud RocketMQ pubsub Doc [1405](https://github.com/dapr/docs/pull/1405)
- **RESOLVED** Add Alibaba Cloud RocketMQ binding doc [1406](https://github.com/dapr/docs/pull/1406)
- **RESOLVED** Add Alibaba Cloud DingTalk Webhook binding doc [1407](https://github.com/dapr/docs/pull/1407)
- **RESOLVED** [CONTENT] Consul nameresolution component [1408](https://github.com/dapr/docs/issues/1408)
- **RESOLVED** sentinel middleware doc  [1439](https://github.com/dapr/docs/pull/1439)
- **RESOLVED** Add documentation for the Zeebe bindings [1441](https://github.com/dapr/docs/pull/1441)
- **RESOLVED** Allow choosing which APIs are available on a sidecar  [1460](https://github.com/dapr/docs/issues/1460)
- **RESOLVED** v1.2 Release [1461](https://github.com/dapr/docs/issues/1461)
- **RESOLVED** Documentation for Preview Features [1463](https://github.com/dapr/docs/issues/1463)
- **RESOLVED** Document how to set the default values for actors [1470](https://github.com/dapr/docs/issues/1470)
- **RESOLVED** [CONTENT] Document pubsub without CE for 1.2 [1474](https://github.com/dapr/docs/issues/1474)
- **RESOLVED** Create a shareable Dapr PowerPoint deck [1477](https://github.com/dapr/docs/issues/1477)
- **RESOLVED** [CONTENT] Add CLI reference docs for `--dapr-http-max-request-size` flags for run [1481](https://github.com/dapr/docs/issues/1481)
- **RESOLVED** Add Docs for Actor Reentrancy [1482](https://github.com/dapr/docs/issues/1482)
### Kit
- **MOVED** logger package from `dapr/dapr` to `dapr/kit` [1](https://github.com/dapr/kit/pull/1)
### Homebrew-tap
- **REPLACED** deprecated formula style with current alternative [20](https://github.com/dapr/homebrew-tap/pull/20)

## Upgrading to Dapr 1.2.0

To upgrade to this release of Dapr, follow the steps here to ensure a smooth upgrade. You know, the one where you don't get red errors on the terminal.. we all hate that, right?

### Local Machine / Self-hosted

Uninstall Dapr using the CLI you currently have installed. Note that this will remove the default $HOME/.dapr directory, binaries and all containers dapr_redis, dapr_placement and dapr_zipkin. Linux users need to run sudo if docker command needs sudo:

```bash
dapr uninstall --all
```

For stable releases like this, download the latest and greatest release from [here](https://github.com/dapr/cli/releases) and put the `dapr` binary in your PATH.

Once you have installed the CLI, run:

```bash
dapr init --runtime-version=1.2.0
```

Wait for the update to finish,  ensure you are using the latest version of Dapr(1.2.0) with:

```bash
$ dapr --version

CLI version: 1.2.0
Runtime version: 1.2.0
```

### Kubernetes

#### Upgrading from previous version

You can perform zero-downtime upgrades using both Helm 3 and the Dapr CLI.

##### Upgrade using the CLI

Download the latest stable release from [here](https://github.com/dapr/cli/releases) and put the `dapr` binary in your PATH.

To upgrade Dapr, run:

```
dapr upgrade --runtime-version 1.2.0 -k
```

To upgrade with high availability mode:

```
dapr upgrade --runtime-version 1.2.0 --enable-ha=true -k
```

Wait until the operation is finished and check your status with `dapr status -k`.

All done!

*Note: Make sure your deployments are restarted to pick the latest version of the Dapr sidecar*

##### Upgrade using Helm

To upgrade Dapr using Helm, run:

```
helm repo add dapr https://dapr.github.io/helm-charts/
helm repo update

helm upgrade dapr dapr/dapr --version 1.2.0 --namespace=dapr-system --wait
```

Wait until the operation is finished and check your status with `dapr status -k`.

All done!

*Note: Make sure your deployments are restarted to pick the latest version of the Dapr sidecar*

#### Starting a fresh install on a cluster

Please see [Deploying Dapr on a Kubernetes cluster](https://v1-2.docs.dapr.io/operations/hosting/kubernetes/kubernetes-deploy/) for a complete guide to installing Dapr on Kubernetes.

You can use Helm 3 to install Dapr:
```
helm repo add dapr https://dapr.github.io/helm-charts/
helm repo update

kubectl create namespace dapr-system

helm install dapr dapr/dapr --version 1.2.0 --namespace dapr-system --wait
```

Alternatively, you can use the latest version of CLI:

```
dapr init --runtime-version=1.2.0 -k
```

##### Post installation

Verify the control plane pods are running and are healthy:

```
$ dapr status -k
  NAME                   NAMESPACE    HEALTHY  STATUS   REPLICAS  VERSION  AGE  CREATED
  dapr-dashboard         dapr-system  True     Running  1         0.6.0    15s  2021-05-20 13:07.39
  dapr-sidecar-injector  dapr-system  True     Running  1         1.2.0   15s  2021-05-20 13:07.39
  dapr-sentry            dapr-system  True     Running  1         1.2.0   15s  2021-05-20 13:07.39
  dapr-operator          dapr-system  True     Running  1         1.2.0   15s  2021-05-20 13:07.39
  dapr-placement         dapr-system  True     Running  1         1.2.0   15s  2021-05-20 13:07.39
```

After Dapr 1.2.0 has been installed, perform a rolling restart for your deployments to pick up the new version of the sidecar.
This can be done with:

```
kubectl rollout restart deploy/<deployment-name>
```

## Breaking Changes

None.